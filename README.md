# Pyspark_assignment

# 1. Question:
# 1.1.Create DataFrame as purchase_data_df, product_data_df with custom schema with the below data
<img width="950" height="944" alt="Screenshot 2025-12-07 124341" src="https://github.com/user-attachments/assets/f3dcb415-e01a-4453-af1b-23b60714fdc6" />

<img width="868" height="600" alt="Screenshot 2025-12-07 124515" src="https://github.com/user-attachments/assets/9d75f393-56bf-4478-9bd8-b24988653ce9" />


# 1.2.Find the customers who have bought only iphone13

<img width="641" height="418" alt="Screenshot 2025-12-07 134122" src="https://github.com/user-attachments/assets/ba62cb83-ff55-40d0-b8f3-10d7d8fa5476" />

# 1.3.Find customers who upgraded from product iphone13 to product iphone14
<img width="910" height="319" alt="Screenshot 2025-12-07 134527" src="https://github.com/user-attachments/assets/fe6b766e-da37-48b9-be6b-595506e33249" />


# 1.4.Find customers who have bought all models in the new Product Data
<img width="733" height="331" alt="Screenshot 2025-12-07 135134" src="https://github.com/user-attachments/assets/df30a02e-b984-4255-8d59-95f11ebecaa6" />


# 2.Question:
<img width="495" height="474" alt="Screenshot 2025-12-07 135830" src="https://github.com/user-attachments/assets/88c9d15a-4a88-4d26-9455-7407ec05eee9" />


# 2.1. print number of partitions


<img width="414" height="253" alt="Screenshot 2025-12-07 142118" src="https://github.com/user-attachments/assets/f153b263-923b-4dc6-8def-08f9e83b620c" />



# 2.2 Increase the partition size to 5 

<img width="660" height="166" alt="Screenshot 2025-12-07 142750" src="https://github.com/user-attachments/assets/b0769db9-3a95-48f7-b9b1-8289b5d1300d" />


# 2.3 Decrease the partition size back to its original partition size 

<img width="693" height="101" alt="image" src="https://github.com/user-attachments/assets/94cd925a-6e4f-4f73-9462-56b3e5a20000" />

<img width="647" height="47" alt="image" src="https://github.com/user-attachments/assets/8a382e79-4fa6-4950-85e5-12d2838504de" />



# 2.4Create a UDF to print only the last 4 digits marking the remaining digits as * 

Eg: ************4567 



<img width="678" height="117" alt="Screenshot 2025-12-07 142809" src="https://github.com/user-attachments/assets/81430f62-611b-42dd-8a60-f51b7ea0fd7f" />




# 2.5 output should have 2 columns as card_number, masked_card_number(with output of question 2) 

<img width="986" height="406" alt="Screenshot 2025-12-07 142833" src="https://github.com/user-attachments/assets/64d0afcd-ff00-43b1-99f9-95f4fe05b381" />


# 3. Question

# 3.1. Create a Data Frame with custom schema creation by using Struct Type and Struct Field Column names: log id, user$id, action, and timestamp.

<img width="591" height="797" alt="Screenshot 2025-12-14 212840" src="https://github.com/user-attachments/assets/4fc152a3-361b-478f-82d4-cd85412023f4" />



# 3.2.Column names should be log_id, user_id, user_activity, time_stamp using dynamic function
<img width="711" height="430" alt="Screenshot 2025-12-14 213150" src="https://github.com/user-attachments/assets/89420ff2-72d4-42da-aad0-2cdad89b01d6" />


# 3.3. Write a query to calculate the number of actions performed by each user in the last 7 days
<img width="727" height="332" alt="Screenshot 2025-12-14 215043" src="https://github.com/user-attachments/assets/eba14a68-2170-422a-bb79-58296f616409" />


# 3.4. Convert the time stamp column to the login_date column with YYYY-MM-DD format with date type as its data type
<img width="587" height="166" alt="Screenshot 2025-12-14 223019" src="https://github.com/user-attachments/assets/d5df3815-82d8-46f7-b4c9-b42fc3e2b1ea" />
<img width="540" height="224" alt="Screenshot 2025-12-14 223040" src="https://github.com/user-attachments/assets/0692339f-cc3e-45e5-8131-bbff484e4e14" />

